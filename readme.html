<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=x-sjis">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title>readme.html</title>
</head>

<body bgcolor="#FFFFFF">

<h1 align="center">UnifyZip</h1>

<p align="center">〜書庫統一〜</p>

<hr>

<h2 align="left"><a name="index">目次</a></h2>

<ul type="square">
    <li><p align="left"><a href="#platform">動作環境</a></p>
    </li>
    <li><p align="left"><a href="#composition">構成ファイル</a></p>
    </li>
    <li><p align="left"><a href="#installation"><font size="3">インストール・アンインストール方法</font></a></p>
    </li>
    <li><p align="left"><a href="#summary"><font size="3">概要</font></a></p>
    </li>
    <li><p align="left"><a href="#direction"><font size="3">使い方</font></a></p>
    </li>
    <li><p align="left"><a href="#option"><font size="3">オプション</font></a></p>
    </li>
    <li><p align="left"><a href="#advice"><font size="3">アドバイス</font></a></p>
    </li>
    <li><p align="left"><a href="#important"><font size="3">注意事項</font></a></p>
    </li>
    <li><p align="left"><a href="#copyright"><font size="3">著作権</font></a></p>
    </li>
    <li><p align="left"><a href="#exemption"><font size="3">免責</font></a></p>
    </li>
    <li><p align="left"><a href="#support"><font size="3">サポート</font></a></p>
    </li>
    <li><p align="left"><a href="#history"><font size="3">更新履歴</font></a></p>
    </li>
<!--
    <li><p align="left"><a href="#plan"><font size="3">予定</font></a></p>
    </li>
-->
    <li><p align="left"><a href="#acknowledgments"><font size="3">謝辞</font></a></p>
    </li>
</ul>



<hr>



<h2><a name="platform">動作環境</a></h2>
<pre style="font-size:100%;">
Windows 2000, XP, 7


※動作には「7-zip32.dll」が必要です。

<b>7-zip32.dll</b>
作者		Akky さん
作者ページ	<a href="http://akky.cjb.net/">http://akky.cjb.net/</a>


また「UNLHA32.DLL」があればLHA形式のファイルも扱えます。
（ただし、処理後のファイルはzip形式となります）

<b>UNLHA32.DLL</b>
作者		Micco さん
作者ページ	<a href="http://www2.nsknet.or.jp/~micco/micindex.html">http://www2.nsknet.or.jp/~micco/micindex.html</a>


加えて「unrar32.dll」があればRAR形式のファイルも扱えます。
（ただし、処理後のファイルはzip形式となります）

<b>unrar32.dll</b>
作者		亀井 哲弥 さん
作者ページ	<a href="http://www.jsdlab.co.jp/~kamei/">http://www.jsdlab.co.jp/~kamei/</a>

なお unrar32.dll の動作には unrar.dll が必要です。

<b>unrar.dll</b>
作者		Eugene Roshal さん
作者ページ	<a href="http://www.diana.dti.ne.jp/~winrar/">http://www.diana.dti.ne.jp/~winrar/</a>


さらに「UNZIP32.DLL」があれば「7-zip32.dll」で扱えない形式のZIPファイルを扱えることがあります。

<b>UNZIP32.DLL</b>
作者		shoda T. さん
作者ページ	<a href="http://www.csdinc.co.jp/">http://www.csdinc.co.jp/</a>
</pre>

<p><a href="#index">目次へ</a></p>



<hr>



<h2><a name="composition">構成ファイル</a></h2>

<p>（以下の３つは全て同じフォルダにいれてください）</p>

<p><font size="4"><strong><u>UnifyZip.exe</u></strong></font><br>
・・・アプリケーション本体</p>

<p><font size="4"><strong><u>UnifyZip.ini</u></strong></font><br>
・・・設定ファイル</p>

<p><font size="4"><strong><u>readme.html</u></strong></font><br>
・・・本ファイル</p>

<p><a href="#index">目次へ</a></p>



<hr>



<h2><a name="installation">インストール・アンインストール方法</a></h2>

<p>インストールは適当なフォルダへアーカイブファイルに含まれる全てのファイルを入れてください。<br>
アーカイブの内容については「構成ファイル」の項を参照してください。</p>

<p>アンインストールは、そのフォルダとその中の全てのファイルを削除してください。<br>
レジストリは一切操作していません。</p>

<p><a href="#index">目次へ</a></p>



<hr>



<h2><a name="summary">概要</a></h2>

<p>
zip(lzh, rar)ファイルに対して<br>
<br>
　・任意のファイル名や拡張子のファイルを取り除く（正規表現で指定）<br>
　・任意のファイル名や拡張子のファイルのみ残す（正規表現で指定）<br>
　・圧縮率を変更する<br>
　・空フォルダを取り除く<br>
　・冗長なフォルダを削除する<br>
　・ファイル、フォルダの更新日時を変更する<br>
　・ファイル、フォルダの属性を変更する<br>
<br>
といったことを行うツールです。<br>
<br>
UnifyZipで処理を行えば<br>
同じものを圧縮してあるはずなのに<br>
二つの書庫が完全に同じものにならない<br>
という状態を解消できます。<br>
<br>
手持ちの書庫を処理してみれば実は同じ書庫だった<br>
なんてことがきっとあるはずです。<br>
<br>
（あと lzh, rar → zip へのコンバーターとしても使えます…。）<br>
</p>

<p><a href="#index">目次へ</a></p>



<hr>



<h2><a name="direction">使い方</a></h2>

<p>
処理を行いたいzip(lzh, rar)ファイルまたは<br>
処理を行いたいzip(lzh, rar)ファイルが含まれるフォルダを<br>
UnifyZip.exeにエクスプローラなどからドラッグアンドドロップすると<br>
コマンドプロンプトが現れて処理が開始されます。<br>
コマンドプロンプトには実行のログが出力されます。<br>
<br>
複数のファイルやフォルダをドラッグアンドドロップすることもできますが<br>
あまり多くのファイルを渡すとエラーが出ます。<br>
（恐らくWindowsの仕様による制限）<br>
<br>
フォルダが渡された場合はそのフォルダ内のファイルを処理します。<br>
<br>
各種設定は「UnifyZip.ini」を編集することで行います。<br>
詳しくは「オプション」の項を参照してください。<br>
</p>

<p><a href="#index">目次へ</a></p>



<hr>



<h2><a name="option">オプション</a></h2>

<pre style="font-size:100%;">
<b>PriorityClass :</b>

	プロセスの優先度を指定

	0	:	通常
	1	:	低
	2	:	高
	3	:	リアルタイム
	4	:	通常以下
	5	:	通常以上


<b>SearchSubfolders :</b>

	フォルダが渡された場合サブフォルダ以下に含まれるファイルも検索して処理するか否か
	
	0	:	サブフォルダ以下は検索しない
	1	:	サブフォルダ以下も検索する


<b>DeletesEmptyFolder :</b>

	空フォルダを削除するか否か
	空フォルダは追加設定や除外設定を行った結果
	空フォルダになったものも含む
	
	0	:	空フォルダを削除しない
	1	:	空フォルダを削除する


<b>UsesRecycleBin :</b>

	元のファイルを削除する際ごみ箱に送るか否か
	
	0	:	削除の際ごみ箱に送らず削除
	1	:	削除の際ごみ箱に送る


<b>RemovesRedundantFolder :</b>

	冗長フォルダを削除するか
	例えば arc.zip の内容が
	arc.zip\folder1\folder2\file1.txt
	arc.zip\folder1\folder2\file2.txt
	で全てであった場合、冗長なフォルダを削除して
	arc.zip\file1.txt
	arc.zip\file2.txt
	のようにするか否か
	
	0	:	冗長フォルダを削除しない
	1	:	冗長フォルダを削除する
	2	:	冗長フォルダを削除する(処理後、書庫ファイル名を冗長フォルダ名に基づくものにする)

	2の場合の処理後の書庫ファイル名は例えば前述の例であれば「folder1.zip」となる


<b>ShowsProgress :</b>

	プログレスダイアログを表示するか否か
	
	0	:	ダイアログを表示しない
	1	:	ダイアログを表示する

	表示を切ると処理にかかる時間が思いの外短縮されます


<b>BatchDecompress :</b>

	一括解凍を行うか否か
	
	0	:	必要なファイルのみ解凍
	1	:	一括解凍

	一括解凍が無効の場合、処理にあたって、書庫の中から最終的に必要なファイルのみを解凍しますが
	一括解凍を有効にすると、一度書庫内の全てのファイル・フォルダを解凍し
	そこから不要なファイルの削除などを行うようになります
	一括解凍の方が解凍の速度的に有利なことが多いと思われますが
	不要なファイルのみが壊れた書庫の解凍に失敗するようになってしまいます
	また、パスワード付きの書庫のパスワード入力に関する処理は各DLLに完全に依存するようになります
	結果としてできあがる書庫に違いはありません


<b>AppendFile :</b>

	処理後残すファイルを正規表現で指定
	（大文字／小文字の区別はされない）
	指定を空にするとこのオプションは無効になる

	例えば
	AppendFile=.*\.jpg|.*\.jpeg
	とすると「.jpg」か「.jpeg」が末尾につくファイルを残す
	
	この指定に該当するファイルから
	除外設定ファイルを除いたものが
	最終的に残るファイルとなる


<b>ExcludeFile :</b>

	処理後取り除くファイルを正規表現で指定
	（大文字／小文字の区別はされない）
	指定を空にするとこのオプションは無効になる
	
	例えば
	ExcludeFile=.*\.exe
	とすると「.exe」が末尾につくファイルを取り除く


<b>CompressLevel :</b>

	圧縮レベルを指定する

	-1	:	通常圧縮
	 0	:	無圧縮
	 1	:	低圧縮
	 9	:	高圧縮

	-1, 1, 0, 9 以外は無効


<b>FileTimeMode :</b>

	ファイルの更新日時の設定

	0	:	変更しない
	1	:	指定の日時にする（FileTimeで指定）


<b>FolderTimeMode :</b>

	フォルダの更新日時の設定

	0	:	変更しない
	1	:	指定の日時にする（FolderTimeで指定）
	2	:	フォルダ内で最新の更新日時を持つファイル・フォルダにあわせる


<b>FileTime :</b>
<b>FolderTime :</b>

	ファイル・フォルダの更新日時の設定
	FileTimeModeやFolderTimeModeオプションが1の場合
	ファイル・フォルダの更新日時がここで指定した日時に変更される

	FileTime=1980/02/21 02:30:12

	のように指定する


<b>FileAttribute :</b>
<b>FolderAttribute :</b>

	ファイル・フォルダの属性の設定
	-1を指定すると属性の変更をしない
	属性は

	読み取り専用		: 1
	隠しファイル		: 2
	システムファイル	: 4
	アーカイブ		: 32

	以上の値の和で指定する

	例えば
	FileAttribute=33
	とすると
	ファイルの属性は「読み取り専用」と「アーカイブ」となる


<b>RemarkableFile :</b>

	注目ファイルを正規表現で指定
	（大文字／小文字の区別はされない）
	注目ファイルがどう扱われるかは
	WarningLevelオプションの説明を参照のこと


<b>WarningLevel :</b>

	警告レベルの設定

	0	:	何もしない

	1	:	書庫内のファイルが全て注目ファイルであった場合
			その旨を知らせ，書庫内のファイル一覧を表示し
			その書庫を処理しない

	2	:	書庫内のファイルに注目ファイルがあった場合
			その旨を知らせ，書庫内のファイル一覧を表示し
			その書庫を処理しない
	
	例えば
	RemarkableFile=.*\.exe
	WarningLevel=1
	とすると
	書庫が「.exe」が末尾につくファイルだけで構成されていた場合その書庫を処理しない

	注目ファイルのチェックは処理前、処理後に行われる


<b>RecyclesIndividualFiles :</b>

	書庫内のファイルを削除する際ごみ箱に送るか否か
	
	0	:	削除の際ごみ箱に送らず削除
	1	:	削除の際ごみ箱に送る

	BatchDecompressオプションが1の場合のみ有効


<b>ExitsImmediately :</b>

	処理後エンターキーの入力を待たずに終了するか否か
	
	0	:	処理後エンターキーの入力を待って終了
	1	:	処理後エンターキーの入力を待たずに終了


<b>PreCheck :</b>

	処理前に、書庫が処理済みかどうかのチェックを行うか否か

	チェックの結果処理済みであると判定された場合は処理を行わない。
	ただし、このチェックは不完全であるため
	処理済みでない書庫を処理済みと判定してしまうことがある。
	
	0	:	書庫が処理済みかどうかのチェックを行わない
	1	:	書庫が処理済みかどうかのチェックを行う

</pre>

<p><a href="#index">目次へ</a></p>



<hr>



<h2><a name="advice">アドバイス</a></h2>

<pre style="font-size:100%;">
「UnifyZip」にて処理を行うと
内容が同じであるのにファイル名が異なっているファイルが見つかるようになるかもしれません。

「UnDup」等のソフトを用いれば
そういったファイル名の異なる同内容のファイルを見つけ削除などを行うことができます。

UnDup
作者		Sim-Gさん
作者ページ	<a href="http://simg.infoseek.livedoor.com/">http://simg.infoseek.livedoor.com/</a>


さて、同じファイルを格納してあるはずの書庫がバイナリ的に一致しないのはなぜでしょうか。
冗長なフォルダを含んでいたり、空フォルダがあったり、余計なファイルがあったり
といったことからそうなることはもちろんあるのでしょう。
しかし、そうでなくとも書庫が一致しないケースがあります。
それは、書庫内のファイルの更新日時や属性が異なっているケースです。
書庫ファイルは、中に含まれるファイル・フォルダの更新日時や属性を保持しているため、
中に含まれるファイル・フォルダの更新日時や属性が書庫にしたときに異なっていた場合、
同じ内容のファイル・フォルダであってもそれらをまとめて作った書庫はバイナリ的に一致しません。
良くあるケースは
・格納したフォルダの更新日時が異なっている
・格納したファイルの「アーカイブ」属性が異なっている
などです。
フォルダの更新日時は解凍しただけで変わる可能性があるので
ある書庫を解凍して圧縮しただけでもできた書庫は元の書庫と一致しない事もあり得ます。

ちなみに、初期状態の設定が僕のお薦めの設定です。
</pre>

<p><a href="#index">目次へ</a></p>



<hr>



<h2><a name="important">注意事項</a></h2>

<pre style="font-size:100%;">
UnifyZip の動作には「7-zip32.dll」等が必要です。
なお、解凍については「7-zip32.dll」等に頼っている関係上
扱えない種類の zip ファイルもあります。
しかし、実際に解凍に失敗するケースとしては
扱えない種類の zip ファイルであるためにそうなるよりも
ファイルが壊れているために失敗するほうが多いと思います。

作者のマシンだとrarファイルを処理した場合
一度 F5 キーを押さないとエクスプローラ上にできあがった zip が表示されません。
同じ現象が起こるようでしたらそのように対処してみてください。

Version 2.18 より UnifyZip 本体で圧縮を行うようになりました。
それに伴い、以前のバージョンで作られたものとは異なる書庫が作成される場合があります。
書庫統一を目的としている以上、こういった変更は避けたかったのですが
統一するならば、自分が正しいと思えるものに統一したいと考え、実行に踏み切りました。
作成される書庫は <a href="http://www.pkware.com/">PKWARE</a> の <a href="http://www.pkware.com/business_and_developers/developer/popups/appnote.txt">.ZIP File Format Specification</a> に準拠するよう心がけています。
書庫内のファイルの並び順については特に言及されていないようなので
Windows のエクスプローラと同様の基準でソートするようにしています。
「準拠できてないよ」「主流の形式はこうなっている」「そこの解釈は違うのでは」
といった情報がありましたら是非作者まで。
</pre>

<p><a href="#index">目次へ</a></p>



<hr>



<h2><a name="copyright">著作権</a></h2>

<p>
「UnifyZip」の著作権はKurimaが保有しています。<br>
転載・配布は内容に変更を加えない限り自由に行なってください。<br>
雑誌等への掲載につきましては事後でも構いませんのでメールでお知らせください。<br>
<br>
e-mail : <a href="mailto:KurimaKDV@hotmail.com">KurimaKDV@hotmail.com</a><br>
home page : <a href="http://kurima.sakura.ne.jp/">http://kurima.sakura.ne.jp/</a><br>
</p>

<p><a href="#index">目次へ</a></p>



<hr>



<h2><a name="exemption">免責</a></h2>

<p>このプログラムを使用したことによって生じたいかなる損害も、作者は免責とさせていただきます。<br>
プログラム上にある、いかなるバグ、欠陥も作者はそれを訂正する義務を負いません。</p>

<p><a href="#index">目次へ</a></p>



<hr>



<h2><a name="support">サポート</a></h2>

<p>「UnifyZip」に不具合を発見した場合は、ホームページの掲示板に書き込むか下記宛にメールを送ってください。なるべく対処したいと思います。<br>
また、こんな機能を追加してほしい、この機能は要らない、といった意見もどしどしお寄せください。<br>
<br>
e-mail : <a href="mailto:KurimaKDV@hotmail.com">KurimaKDV@hotmail.com</a><br>
home page : <a href="http://kurima.sakura.ne.jp/">http://kurima.sakura.ne.jp/</a><br>

<p><a href="#index">目次へ</a></p>



<hr>



<h2><a name="history">更新履歴</a></h2>

<p>













2005/02/28<br>
　- Version 2.00
<ul>
<li>初版</li>
</ul>

2005/03/08<br>
　- Version 2.01
<ul>
<li>正規表現によるマッチングは大文字小文字を区別しないようにした </li>
<li>書庫に含まれるファイル名によっては解凍に失敗するのを修正</li>
<li>処理が不要な書庫かどうか事前にチェックし結果に応じて処理をスキップするようにした（圧縮レベル 0 に限る）</li>
</ul>

2005/03/09<br>
　- Version 2.02
<ul>
<li>RAR形式に対応</li>
</ul>

2005/04/03<br>
　- Version 2.03
<ul>
<li>パスワードつきZIPの解凍で独自のパスワード入力ダイアログをだすようにした</li>
<li>パスワードつきZIPの解凍で書庫内のファイルひとつひとつに対してパスワードを聞かれる部分を改善</li>
</ul>

2005/04/13<br>
　- Version 2.04
<ul>
<li>UNZIP32.DLLに対応</li>
</ul>

2005/07/03<br>
　- Version 2.05
<ul>
<li>内容は処理済みだが拡張子が「.zip」となっていない書庫の拡張子を「.zip」にリネームするようにした<br>（以前は一切手を加えず処理をスキップしていた）</li>
<li>処理が不要かどうかのチェックをより厳密かつ高速に行うようにした<br>（ファイル属性をより厳密にチェック, version needed to extract のチェック, ファイルの並び順のチェック）</li>
</ul>

2005/07/05<br>
　- Version 2.06
<ul>
<li>一括解凍のオプション（BatchDecompress）を追加<br>
</ul>

2005/07/10<br>
　- Version 2.07
<ul>
<li>空フォルダの判定を間違えて処理に失敗することがあったのを修正<br>
<li>不正なファイルを渡したときに場合によって強制終了してしまうのを修正<br>
</ul>

2005/07/15<br>
　- Version 2.08
<ul>
<li>サブフォルダ以下検索のオプション（SearchSubfolders）を追加<br>
</ul>

2005/08/02<br>
　- Version 2.09
<ul>
<li>一括解凍のオプション使用時除外対象のファイルが読み取り専用だと削除に失敗するのを修正<br>
</ul>

2005/08/10<br>
　- Version 2.10
<ul>
<li>書庫内のフォルダ名によっては処理が終わらない事があったのを修正<br>
</ul>

2005/09/25<br>
　- Version 2.11
<ul>
<li>書庫内のファイル名の長さによってはエラーが起きる事があったのを修正<br>
</ul>

2005/10/23<br>
　- Version 2.12
<ul>
<li>「UNZIP32.DLL」を用いた処理で書庫ではないファイルを書庫と見なす事があったのを修正<br>
</ul>

2005/10/27<br>
　- Version 2.13
<ul>
<li>ファイルの並び順が正しくなくても処理が不要かどうかのチェックに通ってしまっていたのを修正<br>
</ul>

2005/11/09<br>
　- Version 2.14
<ul>
<li>書庫内の読み取り専用のファイルが削除できない事があったのを修正<br>
<li>プロセスの優先順位クラスを指定するオプション（PriorityClass）を追加<br>
</ul>

2005/11/16<br>
　- Version 2.15
<ul>
<li>エラーとなりそうな部分に回避用コードを追加<br>
</ul>

2005/11/18<br>
　- Version 2.16
<ul>
<li>BatchDecompress=0 で正しい処理ができない事があったのを修正<br>
</ul>

2005/11/29<br>
　- Version 2.17
<ul>
<li>「UNZIP32.DLL」を用いた処理で書庫内のファイル名が不正だと異常終了する事あったので事前にチェックして回避するようにした<br>
</ul>

2006/02/12<br>
　- Version 2.18
<ul>
<li>「7-zip32.dll」を用いていた圧縮処理を UnifyZip 本体で行うようにした<br>
</ul>

2006/02/14<br>
　- Version 2.19
<ul>
<li>書庫内にサイズ 0 のファイルがあると圧縮処理に失敗するのを修正<br>
<li>処理済みファイルのチェックと圧縮処理を若干高速化<br>
</ul>

2006/02/19<br>
　- Version 2.20
<ul>
<li>必要なファイルのみ解凍だと「7-zip32.dll（Version 4.31.00.01）」での解凍に失敗するのを修正<br>
<li>必要なファイルのみ解凍だと書庫によっては冗長なフォルダの検出に失敗するのを修正<br>
</ul>

2006/02/23<br>
　- Version 2.21
<ul>
<li>警告オプション（RemarkableFile, WarningLevel）を追加<br>
</ul>

2006/03/10<br>
　- Version 2.22
<ul>
<li>書庫の処理を書庫の名前順に行うようにした<br>
<li>処理済みと判定した書庫についても注目ファイルのチェックを行うようにした<br>
<li>処理後にも注目ファイルのチェックを行うようにした<br>
<li>書庫内の不要なファイルをゴミ箱に送るオプション（RecyclesIndividualFiles）を追加<br>
</ul>

2006/04/12<br>
　- Version 2.23
<ul>
<li>空の書庫もしくは壊れて空に見える書庫であるかチェックするようにした<br>
<li>処理後エンターキーの入力を待たずに終了するか否かのオプション（ExitsImmediately）を追加<br>
</ul>

2007/01/16<br>
　- Version 2.24
<ul>
<li>書庫が処理済みかどうかのチェックを行うか否かのオプション（PreCheck）を追加<br>
</ul>

2008/01/05<br>
　- Version 2.25
<ul>
<li>オプション RemovesRedundantFolder に処理後、書庫ファイル名を冗長フォルダ名に基づくものにする指定を追加<br>
<li>処理後、書庫ファイル名のリネームに失敗した場合、時間をおいてリトライするようにした<br>
</ul>

2008/01/07<br>
　- Version 2.26
<ul>
<li>Version 2.25 で追加した指定だと冗長フォルダが無い場合書庫ファイル名が拡張子のみになってしまう不具合を修正<br>
</ul>

2014/05/20<br>
　- Version 2.27
<ul>
<li>新しいバージョンの UNRAR32.DLL(version 0.13) に対応<br>
</ul>





</p>

<p><a href="#index">目次へ</a></p>



<hr>

<!--

<h2><a name="plan">予定</a></h2>

<ul>
<li>GUI作成</li>
</ul>

…やる気とリクエストがあれば…。

<p><a href="#index">目次へ</a></p>

<hr>

-->


<h2><a name="acknowledgments">謝辞</a></h2>

動作テストをし、的確なアドバイスや感想をくれた yusuke氏 にこの場を借りてお礼を申し上げます。

<p><a href="#index">目次へ</a></p>



<hr>



</body>
</html>
